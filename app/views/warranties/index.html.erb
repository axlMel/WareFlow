<div class="min-h-screen flex flex-col lg:flex-row gap-6 p-4 lg:p-6">
  <!-- Sidebar de filtros -->
  <div class="w-full lg:w-1/4 space-y-4">
    <div class="bg-white p-4 rounded-2xl shadow space-y-4">
      <h1 class="text-2xl font-bold text-gray-800">Garantías</h1>

      <%= form_with url: warranties_path, method: :get, local: true do |form| %>
        <div class="space-y-4">
          <!-- Cliente -->
          <div>
            <%= form.label :client, "Cliente", class: "block text-sm font-medium text-gray-700" %>
            <%= form.text_field :client, class: "w-full border border-gray-300 rounded-lg px-3 py-2" %>
          </div>

          <!-- Folio -->
          <div>
            <%= form.label :folio, "Folio", class: "block text-sm font-medium text-gray-700" %>
            <%= form.number_field :folio, class: "w-full border border-gray-300 rounded-lg px-3 py-2" %>
          </div>

          <!-- Usuario -->
          <div>
            <%= form.label :user_id, "Usuario", class: "block text-sm font-medium text-gray-700" %>
            <%= form.collection_select :user_id, @users, :id, :username, { include_blank: true }, class: "w-full border border-gray-300 rounded-lg px-3 py-2" %>
          </div>

          <!-- Estado -->
          <div>
            <%= form.label :status, "Estado", class: "block text-sm font-medium text-gray-700" %>
            <%= form.select :status, [['Creado', 0], ['Asignado', 1]], { include_blank: true }, class: "w-full border border-gray-300 rounded-lg px-3 py-2" %>
          </div>

          <div class="pt-2">
            <%= form.submit 'Filtrar', class: "w-full bg-indigo-600 text-white font-semibold px-4 py-2 rounded-xl hover:bg-indigo-700 transition" %>
          </div>
        </div>
      <% end %>

      <div class="pt-4 flex justify-center">
        <%= link_to "Nueva Garantía", new_warranty_path, data: { turbo_frame: "modal" }, class: "bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-xl text-sm font-medium shadow" %>
      </div>
    </div>
  </div>

  <!-- Panel principal -->
  <div class="w-full lg:w-3/4 space-y-4">
    <div class="bg-white p-4 rounded-2xl shadow">
      <h2 class="text-xl font-semibold mb-4">Historial de Garantías</h2>

      <% if @warranties.any? %>
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm text-left border-collapse">
            <thead class="text-xs text-gray-500 uppercase border-b">
              <tr>
                <th class="px-6 py-3">Folio</th>
                <th class="px-6 py-3">Cliente</th>
                <th class="px-6 py-3">Usuario</th>
                <th class="px-6 py-3">Estado</th>
                <th class="px-6 py-3">Fecha</th>
                <th class="px-6 py-3">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <% @warranties.each do |warranty| %>
                <tr class="border-t hover:bg-gray-50">
                  <td class="px-6 py-4"><%= warranty.id %></td>
                  <td class="px-6 py-4"><%= warranty.client %></td>
                  <td class="px-6 py-4"><%= warranty.user&.username || "N/A" %></td>
                  <td class="px-6 py-4">
                    <span class="inline-block px-2 py-1 rounded-full text-xs font-semibold
                      <%= warranty.state == 1 ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800' %>">
                      <%= warranty.state == 1 ? 'Asignado' : 'Creado' %>
                    </span>
                  </td>
                  <td class="px-6 py-4"><%= l(warranty.created_at, format: :short) %></td>
                  <td class="px-6 py-4 space-x-2 whitespace-nowrap">
                    <%= link_to "Ver", warranty_path(warranty), class: "text-blue-600 hover:underline text-sm", data: { turbo_frame: "modal" } %>
                    <%= link_to "Editar", edit_warranty_path(warranty), class: "text-yellow-600 hover:underline text-sm", data: { turbo_frame: "modal" } %>
                    <%= link_to "Eliminar", warranty_path(warranty), method: :delete, data: { confirm: "¿Estás seguro?" }, class: "text-red-600 hover:underline text-sm" %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <p class="text-gray-600">No hay garantías registradas.</p>
      <% end %>
    </div>
  </div>
</div>
