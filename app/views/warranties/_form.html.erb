<%= form_with(model: warranty, data: { turbo_frame: "_top"}, class: "space-y-4") do |form| %>
  <% if warranty.errors.any? %>
    <div class="bg-red-100 text-red-800 border border-red-300 p-4 rounded-xl shadow-sm">
      <h2 class="font-semibold mb-2">
        <%= pluralize(warranty.errors.count, "error(es)") %> impidieron guardar la garantía.
      </h2>
      <ul class="list-disc list-inside text-sm">
        <% warranty.errors.full_messages.each do |message| %>
        <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <!-- Producto -->
  <div>
    <%= form.label :product_id, "Producto", class: "block text-sm font-semibold text-gray-700 mb-1" %>
    <%= form.collection_select :product_id, @products, :id, :title, { prompt: "Selecciona un producto" }, class: "w-full border border-gray-300 rounded-xl px-4 py-2 shadow-sm focus:ring focus:ring-indigo-200" %>
  </div>

  <!-- Cliente -->
  <div>
    <%= form.label :client, "Cliente de procedencia", class: "block text-sm font-semibold text-gray-700 mb-1" %>
    <%= form.text_field :client, class: "w-full border border-gray-300 rounded-xl px-4 py-2 shadow-sm focus:ring focus:ring-indigo-200" %>
  </div>

  <!-- Usuario -->
  <div>
    <%= form.label :user_id, "Usuario de procedencia", class: "block text-sm font-semibold text-gray-700 mb-1" %>
    <%= form.collection_select :user_id, @users, :id, :username, { prompt: "Selecciona un usuario" }, class: "w-full border border-gray-300 rounded-xl px-4 py-2 shadow-sm focus:ring focus:ring-indigo-200" %>
  </div>

  <!-- Estado -->
  <div>
    <% if action_name == "edit" || action_name == "update" %>
      <div>
        <%= form.label :state, "Estado", class: "block text-sm font-semibold text-gray-700 mb-1" %>

        <%= form.select :state, [['Pendiente', :pending], ['En proceso', :in_process], ['Completado', :completed]], {}, class: "w-full border border-gray-300 rounded-xl px-4 py-2 shadow-sm focus:ring focus:ring-indigo-200" %>
      </div>
    <% end %>
  </div>

  <!-- Comentario -->
  <div>
    <%= form.label :commit, "Comentarios", class: "block text-sm font-semibold text-gray-700 mb-1" %>
    <%= form.text_area :commit, rows: 3, class: "w-full border border-gray-300 rounded-xl px-4 py-2 shadow-sm focus:ring focus:ring-indigo-200" %>
  </div>

  <!-- Submit -->
  <div class="pt-4">
    <%= form.submit warranty.new_record? ? "Crear garantía" : "Actualizar garantía", class: "w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold px-4 py-2 rounded-xl shadow" %>
  </div>

<% end %>
