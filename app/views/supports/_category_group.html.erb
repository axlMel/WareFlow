<%# =============================== %>
<%# supports/_category_group.html.erb (RENDEREA TARJETAS Y TABLA) %>
<%# =============================== %>


<% tarjetas_validas = ["Dispositivos", "Accesorio"] %>

<% grouped_products.each do |category, products| %>
  <% next unless tarjetas_validas.include?(category) %>

  <div class="mb-4">
    <h3 class="text-lg font-semibold text-gray-700 mb-2"><%= category %></h3>
    <div class="text-sm text-gray-600 italic border-l-4 border-blue-400 pl-4 bg-blue-50 py-1 max-w-fit self-start mb-4">
      üß© Selecciona alg√∫n accesorio o dispositivo para ver su diagrama y comandos 
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
      <% products.each do |product| %>
        <%= render partial: "supports/product_card", locals: { product: product } %>
      <% end %>
    </div>
  </div>
<% end %>

<%# =============================== %>
<%# TABLA PARA CATEGOR√çAS RESTANTES %>
<%# =============================== %>
<% other_categories = grouped_products.reject { |cat, _| tarjetas_validas.include?(cat) } %>
<% if other_categories.present? %>
  <div class="mt-2 flex flex-col items-center w-full">
    <h2 class="text-center text-lg font-semibold text-gray-700 mb-4">
      Listado de productos restantes:
    </h2>

    <div class="bg-gray-100 p-4 rounded-2xl shadow overflow-x-auto">
    <div class="mx-auto max-w-6xl w-full">
        <table class="min-w-full text-sm table-auto bg-white">
          <thead class="bg-gray-100 text-gray-600 uppercase text-xs">
            <tr>
              <th class="py-2 px-3">T√≠tulo</th>
              <th class="py-2 px-3">Stock</th>
              <th class="py-2 px-3">Categor√≠a</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            <% other_categories.each do |category, products| %>
              <% products.each do |product| %>
                <tr class="border-b hover:bg-gray-50">
                  <td class="px-6 py-4"><%= product[:title] %></td>
                  <td class="px-6 py-4"><%= product[:stock] || 1 %></td>
                  <td class="px-6 py-4 text-gray-500"><%= category %></td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
<% end %>
